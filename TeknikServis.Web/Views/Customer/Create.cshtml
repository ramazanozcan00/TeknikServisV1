@model TeknikServis.Core.Entities.Customer

@{
    ViewData["Title"] = "Yeni Müşteri";
}

<div class="row justify-content-center">
    <div class="col-lg-10">
        <div class="card shadow border-0">
            <div class="card-header bg-primary text-white py-3">
                <h4 class="mb-0"><i class="fa-solid fa-user-plus me-2"></i>Yeni Müşteri Kaydı</h4>
            </div>
            <div class="card-body p-4">

                <form asp-action="Create" method="post">

                    <h6 class="text-muted text-uppercase mb-3 small fw-bold border-bottom pb-2">Genel Bilgiler</h6>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label fw-bold">Müşteri Tipi</label>
                            <select asp-for="CustomerType" class="form-select" id="customerTypeSelect">
                                <option value="Normal">Normal Müşteri</option>
                                <option value="Esnaf">Esnaf</option>
                                <option value="Bayi">Bayi</option>
                                <option value="Problemli" class="text-danger fw-bold">!!! Problemli Müşteri !!!</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Firma İsmi</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-building"></i></span>

                                <input asp-for="CompanyName" class="form-control" list="companyOptions" placeholder="Firma seçin veya yazın..." autocomplete="off" />

                                <datalist id="companyOptions">
                                    @if (ViewBag.CompanyList != null)
                                    {
                                        foreach (var companyName in (List<string>)ViewBag.CompanyList)
                                        {
                                            <option value="@companyName"></option>
                                        }
                                    }
                                </datalist>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Ad <span class="text-danger">*</span></label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-user"></i></span>
                                <input asp-for="FirstName" class="form-control" required />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Soyad <span class="text-danger">*</span></label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-user"></i></span>
                                <input asp-for="LastName" class="form-control" required />
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">TC Kimlik No</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-id-card"></i></span>
                                <input asp-for="TCNo" class="form-control" maxlength="11" placeholder="11 haneli..." />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">E-Posta</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-envelope"></i></span>
                                <input asp-for="Email" type="email" class="form-control" />
                            </div>
                        </div>
                    </div>

                    <h6 class="text-muted text-uppercase mb-3 mt-4 small fw-bold border-bottom pb-2">İletişim Bilgileri</h6>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Telefon 1 <span class="text-danger">*</span></label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-mobile-screen text-success"></i></span>
                                <input asp-for="Phone" class="form-control" placeholder="0555..." required />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Telefon 2 (Yedek)</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-phone"></i></span>
                                <input asp-for="Phone2" class="form-control" placeholder="Sabit hat veya yedek..." />
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="mb-3">
                            <label class="form-label">Açık Adres</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-map-location-dot"></i></span>
                                <textarea asp-for="Address" class="form-control" rows="2" placeholder="Mahalle, Sokak, Kapı No..."></textarea>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">İl</label>
                            <select asp-for="City" class="form-select" id="citySelect">
                                <option value="">Seçiniz...</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">İlçe</label>
                            <select asp-for="District" class="form-select" id="districtSelect" disabled>
                                <option value="">Önce İl Seçiniz</option>
                            </select>
                        </div>
                    </div>

                    <h6 class="text-muted text-uppercase mb-3 mt-4 small fw-bold border-bottom pb-2">Fatura & Vergi Bilgileri</h6>
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label class="form-label">Vergi Dairesi</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-building-columns"></i></span>
                                <input asp-for="TaxOffice" class="form-control" />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Vergi No</label>
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="fa-solid fa-file-invoice"></i></span>
                                <input asp-for="TaxNumber" class="form-control" />
                            </div>
                        </div>
                    </div>

                    <div class="d-flex justify-content-end gap-2">
                        <a asp-action="Index" class="btn btn-secondary">
                            <i class="fa-solid fa-arrow-left me-2"></i>Listeye Dön
                        </a>
                        <button type="submit" class="btn btn-primary px-5">
                            <i class="fa-solid fa-save me-2"></i>Kaydet
                        </button>
                    </div>

                </form>

            </div>
        </div>
    </div>
</div>

<script>
    // Türkiye İl ve İlçeleri (Örnek Veri Seti - Kısaltılmıştır)
    // Projenizde tüm listeyi JSON dosyasından çekmeniz daha iyi olur.
    const iller = {
        "İstanbul": ["Adalar", "Arnavutköy", "Ataşehir", "Avcılar", "Bağcılar", "Bahçelievler", "Bakırköy", "Başakşehir", "Bayrampaşa", "Beşiktaş", "Beykoz", "Beylikdüzü", "Beyoğlu", "Büyükçekmece", "Çatalca", "Çekmeköy", "Esenler", "Esenyurt", "Eyüpsultan", "Fatih", "Gaziosmanpaşa", "Güngören", "Kadıköy", "Kağıthane", "Kartal", "Küçükçekmece", "Maltepe", "Pendik", "Sancaktepe", "Sarıyer", "Silivri", "Sultanbeyli", "Sultangazi", "Şile", "Şişli", "Tuzla", "Ümraniye", "Üsküdar", "Zeytinburnu"],
        "Ankara": ["Akyurt", "Altındağ", "Ayaş", "Bala", "Beypazarı", "Çamlıdere", "Çankaya", "Çubuk", "Elmadağ", "Etimesgut", "Evren", "Gölbaşı", "Güdül", "Haymana", "Kalecik", "Kazan", "Keçiören", "Kızılcahamam", "Mamak", "Nallıhan", "Polatlı", "Pursaklar", "Sincan", "Şereflikoçhisar", "Yenimahalle"],
        "İzmir": ["Aliağa", "Balçova", "Bayındır", "Bayraklı", "Bergama", "Beydağ", "Bornova", "Buca", "Çeşme", "Çiğli", "Dikili", "Foça", "Gaziemir", "Güzelbahçe", "Karabağlar", "Karaburun", "Karşıyaka", "Kemalpaşa", "Kınık", "Kiraz", "Konak", "Menderes", "Menemen", "Narlıdere", "Ödemiş", "Seferihisar", "Selçuk", "Tire", "Torbalı", "Urla"],
        "Adana": ["Aladağ", "Ceyhan", "Çukurova", "Feke", "İmamoğlu", "Karaisalı", "Karataş", "Kozan", "Pozantı", "Saimbeyli", "Sarıçam", "Seyhan", "Tufanbeyli", "Yumurtalık", "Yüreğir"],
        "Bursa": ["Büyükorhan", "Gemlik", "Gürsu", "Harmancık", "İnegöl", "İznik", "Karacabey", "Keles", "Kestel", "Mudanya", "Mustafakemalpaşa", "Nilüfer", "Orhaneli", "Orhangazi", "Osmangazi", "Yenişehir", "Yıldırım"],
        "Antalya": ["Akseki", "Aksu", "Alanya", "Demre", "Döşemealtı", "Elmalı", "Finike", "Gazipaşa", "Gündoğmuş", "İbradı", "Kaş", "Kemer", "Kepez", "Konyaaltı", "Korkuteli", "Kumluca", "Manavgat", "Muratpaşa", "Serik"]
        // ... Diğer iller buraya eklenebilir
    };

    document.addEventListener("DOMContentLoaded", function() {
        const citySelect = document.getElementById("citySelect");
        const districtSelect = document.getElementById("districtSelect");

        // İlleri Doldur
        for (let il in iller) {
            let option = document.createElement("option");
            option.value = il;
            option.text = il;
            citySelect.appendChild(option);
        }

        // İl Seçildiğinde İlçeleri Getir
        citySelect.addEventListener("change", function() {
            const secilenIl = this.value;

            // İlçe listesini temizle
            districtSelect.innerHTML = '<option value="">Seçiniz...</option>';

            if (secilenIl && iller[secilenIl]) {
                districtSelect.disabled = false;

                // Seçilen ilin ilçelerini ekle
                iller[secilenIl].forEach(function(ilce) {
                    let option = document.createElement("option");
                    option.value = ilce;
                    option.text = ilce;
                    districtSelect.appendChild(option);
                });
            } else {
                districtSelect.disabled = true;
                districtSelect.innerHTML = '<option value="">Önce İl Seçiniz</option>';
            }
        });
    });
</script>